apiVersion: 1

providers:
  - name: 'Food Delivery Dashboards'
    orgId: 1
    folder: ''
    folderUid: ''
    type: file
    disableDeletion: false
    updateIntervalSeconds: 10
    allowUiUpdates: true
    options:
      path: /etc/grafana/provisioning/dashboards

dashboards:
  - name: 'Order Metrics'
    uid: 'order-metrics'
    editable: true
    panels:
      - title: 'Active Orders'
        type: 'stat'
        datasource: 'Prometheus'
        targets:
          - expr: 'sum(order_status{status=~"PREPARING|READY|OUT_FOR_DELIVERY"})'
      
      - title: 'Orders Per Minute'
        type: 'graph'
        datasource: 'Prometheus'
        targets:
          - expr: 'rate(orders_total[5m])'

      - title: 'Average Order Value'
        type: 'gauge'
        datasource: 'Prometheus'
        targets:
          - expr: 'avg(order_value)'

  - name: 'Delivery Metrics'
    uid: 'delivery-metrics'
    editable: true
    panels:
      - title: 'Active Delivery Agents'
        type: 'stat'
        datasource: 'Prometheus'
        targets:
          - expr: 'sum(delivery_agents{status="ACTIVE"})'
      
      - title: 'Average Delivery Time'
        type: 'graph'
        datasource: 'Prometheus'
        targets:
          - expr: 'rate(delivery_time_seconds_sum[5m]) / rate(delivery_time_seconds_count[5m])'

  - name: 'AI Service Metrics'
    uid: 'ai-metrics'
    editable: true
    panels:
      - title: 'Voice Order Success Rate'
        type: 'gauge'
        datasource: 'Prometheus'
        targets:
          - expr: 'sum(voice_order_success) / sum(voice_order_total)'
      
      - title: 'Recommendation Acceptance Rate'
        type: 'graph'
        datasource: 'Prometheus'
        targets:
          - expr: 'sum(recommendation_accepted) / sum(recommendation_total)'

      - title: 'Weather-Based Order Correlation'
        type: 'heatmap'
        datasource: 'Prometheus'
        targets:
          - expr: 'weather_order_correlation'

  - name: 'System Health'
    uid: 'system-health'
    editable: true
    panels:
      - title: 'Service Health'
        type: 'stat'
        datasource: 'Prometheus'
        targets:
          - expr: 'up'
      
      - title: 'JVM Memory Usage'
        type: 'graph'
        datasource: 'Prometheus'
        targets:
          - expr: 'jvm_memory_used_bytes'

      - title: 'API Response Times'
        type: 'graph'
        datasource: 'Prometheus'
        targets:
          - expr: 'http_server_requests_seconds_count'